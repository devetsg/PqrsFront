<section class="result">
  <div class="result-container">
    <div *ngIf="data.area == 'FAC'" class="dialog--container-texts">
      <h2 class="dialog--container-texts-title">Trazabilidad de Facturacion</h2>
    </div>
    <div *ngIf="data.area == 'OP'" class="dialog--container-texts">
      <h2 class="dialog--container-texts-title">Trazabilidad de Operacion</h2>
    </div>
    <div *ngIf="data.area == 'TS'" class="dialog--container-texts">
      <h2 class="dialog--container-texts-title">Trazabilidad de Transporte</h2>
    </div>
    <div class="result-container-data">
      <div class="result-container-data-obs card">
        <h4 class="result-container-data-title">Solicitud Realizada</h4>
        <h4 class="result-container-data-date">
          <span *ngIf="data.area == 'FAC'">
            {{pqr.dateSendToMinerFac | date}}
          </span>
          <span *ngIf="data.area == 'OP'">
            {{pqr.dateSendToMinerOp | date}}
          </span>
          <span *ngIf="data.area == 'TS'">
            {{pqr.dateSendToMinerTs | date}}
          </span>
        </h4>
        <h4 class="result-container-data-content">
          <span *ngIf="data.area == 'FAC'">
            {{pqr.observationToMinerFac}}
          </span>
          <span *ngIf="data.area == 'OP'">
            {{pqr.observationToMinerOp}}
          </span>
          <span *ngIf="data.area == 'TS'">
            {{pqr.observationToMinerTs}}
          </span>

        </h4>
      </div>
      <div *ngIf="pqr.observationFromMinerFac != null ||  pqr.observationFromMinerOp != null
                || pqr.observationFromMinerTs != null" class="result-container-data-obs card">
        
        <div class="btn2">
          <h4 class="result-container-data-title">Respuesta</h4>
          <h4 class="result-container-data-date">
            <span *ngIf="data.area == 'FAC'">
              {{pqr.dateResponseMinerFac | date}}
            </span>
            <span *ngIf="data.area == 'OP'">
              {{pqr.dateResponseMinerOp | date}}
            </span>
            <span *ngIf="data.area == 'TS'">
              {{pqr.dateResponseMinerTs | date}}
            </span>
          </h4>
          <h4 class="result-container-data-content">
            <span *ngIf="data.area == 'FAC'">
              {{pqr.observationFromMinerFac != null ? pqr.observationFromMinerFac : 'El area asignada no ha enviado una respuesta'}}
            </span>
            <span *ngIf="data.area == 'OP'">
              {{pqr.observationFromMinerOp != null ? pqr.observationFromMinerOp : 'El area asignada no ha enviado una respuesta'}}
            </span>
            <span *ngIf="data.area == 'TS'">
              {{pqr.observationFromMinerTs != null ? pqr.observationFromMinerTs : 'El area asignada no ha enviado una respuesta'}}
            </span>

          </h4>
        </div>
        
      </div>
      <form class="create--container-div1-form-container-form" [formGroup]="formMinner" (ngSubmit)="submit()">
        <div class="response--headers-container-data-miner cont">
          <!-- <h2 class="response--labels">Adjuntos</h2><br/> -->
          <!-- <div class="response--labels-data-attachments"> -->
          <div *ngIf="pqr.minerUrlsFac != null">
            <div *ngIf="data.area == 'FAC' && pqr.minerUrlsFac.length > 0">
              <h2 style="margin-bottom: 15px;" class="response--labels">Datos Obtenidos: <i style="font-size: 25px;" class="bi bi-database-fill-check"></i></h2>
              <div class="btns-container">
                <div *ngFor="let name of minedAttachmentsFac" class="response--labels-data flex gap">
                  <div class="flex button-new" (click)="getAttach(name)">
                    <img [src]="getIcon(name)" alt="Icon" style="width: 30px; height: 30px; margin-right: 10px; margin-top: 2px;">
                    <span class="span">{{ truncateFilename(name.replace('Resources/Attach/', ''), 20) }}</span>
                  </div>
                </div>
              </div>
              <div class="reject">
                
                <button style="margin-top: 10px;" (click)="showReject()"  class="response--container-form-container-form-btn-sec" mat-fab extended color="primary">
                  Rechazar Respuesta
                </button>

                <h2 *ngIf="isMinerFac && showInput" style="margin-bottom: 15px;margin-top: 15px;" class="response--labels">Solicitar Trazabilidad: </h2>
               
                <div *ngIf="isMinerFac && showInput" class="grid2" rowspan="1">
                  <mat-form-field class="create--container-div1-form-container-form-field" appearance="fill">
                    <mat-label>Observacion para Facturacion</mat-label>
                    <textarea class="" matInput formControlName="observationFac"></textarea>
                  </mat-form-field>
                </div>

                
                <div style="display: flex;gap: 30px;">
                  <button style="margin-top: 10px;margin-bottom: 10px;" *ngIf="isMinerOp && showInput" (click)="showReject()"  class="response--container-form-container-form-btn-dev" mat-fab extended color="primary">
                    Cancelar
                  </button>
                  <button style="margin-top: 10px;" *ngIf="isMinerOp && showInput" type="submit" class="response--container-form-container-form-btn-sec" mat-fab extended color="primary">
                    Enviar Solicitud
                  </button>
                </div>
               
              </div>
            </div>
          </div>
          <div *ngIf="pqr.minerUrlsOp != undefined && (data.area == 'OP' && pqr.minerUrlsOp.length > 0)">
            <h2 style="margin-bottom: 15px;" class="response--labels">Datos Obtenidos: <i style="font-size: 25px;" class="bi bi-database-fill-check"></i></h2>
            <div class="btns-container">
              <div *ngFor="let name of minedAttachmentsOp" class="response--labels-data flex gap">
                <div class="flex button-new" (click)="getAttach(name)">
                  <img [src]="getIcon(name)" alt="Icon" style="width: 30px; height: 30px; margin-right: 10px; margin-top: 2px;">
                  <span class="span">{{ truncateFilename(name.replace('Resources/Attach/', ''), 20) }}</span>
                </div>
              </div>
              <i (click)="downloadFull()" style="margin-left:15px;font-size: 28px; color: #14642c;cursor: pointer;" class="bi bi-cloud-download-fill"></i>
            </div>
            <div class="reject">
              
              <button style="margin-top: 10px;" *ngIf="!showInput && role == 'ANALISTA'" (click)="showReject()"  class="response--container-form-container-form-btn-red" mat-fab extended color="primary">
                Rechazar Respuesta
              </button>
              <h2 *ngIf="isMinerOp && showInput" style="margin-bottom: 15px;margin-top: 15px;" class="response--labels">Solicitar Trazabilidad: </h2>
              <div *ngIf="isMinerOp && showInput" class="grid2" rowspan="1">
                <mat-form-field class="create--container-div1-form-container-form-field" appearance="fill">
                  <mat-label>Observacion para Operacion</mat-label>
                  <textarea class="" matInput formControlName="observationOp"></textarea>
                </mat-form-field>
              </div>
              
              <div style="display: flex;gap: 30px;">
                <button style="margin-top: 10px;margin-bottom: 10px;" *ngIf="isMinerOp && showInput" (click)="showReject()"  class="response--container-form-container-form-btn-dev" mat-fab extended color="primary">
                  Cancelar
                </button>
                <button style="margin-top: 10px;" *ngIf="isMinerOp && showInput" type="submit" class="response--container-form-container-form-btn-sec" mat-fab extended color="primary">
                  Enviar Solicitud
                </button>
              </div>
             
            </div>
          </div>
          
          <div *ngIf="pqr.minerUrlsTs != undefined && (data.area == 'TS' && pqr.minerUrlsTs.length > 0)">
            <h2 style="margin-bottom: 15px;" class="response--labels">Datos Obtenidos: <i style="font-size: 25px;" class="bi bi-database-fill-check"></i></h2>
            <div class="btns-container">
              <div *ngFor="let name of minedAttachmentsTs" class="response--labels-data flex gap">
                <div class="flex button-new" (click)="getAttach(name)">
                  <img [src]="getIcon(name)" alt="Icon" style="width: 30px; height: 30px; margin-right: 10px;margin-top:2px;">
                  <span class="span">{{ truncateFilename(name.replace('Resources/Attach/', ''), 20) }}</span>
                </div>
              </div>
            </div>
            <div class="reject">
             
              <button style="margin-top: 10px;" (click)="showReject()"  class="response--container-form-container-form-btn-sec" mat-fab extended color="primary">
                Rechazar Respuesta
              </button>
              <h2 *ngIf="isMinerTs && showInput" style="margin-bottom: 15px;margin-top: 15px;" class="response--labels">Solicitar Trazabilidad: </h2>
             
              <div *ngIf="isMinerTs && showInput" class="grid2" rowspan="1">
                <mat-form-field class="create--container-div1-form-container-form-field" appearance="fill">
                  <mat-label>Observacion para Trasnsporte</mat-label>
                  <textarea class="" matInput formControlName="observationTs"></textarea>
                </mat-form-field>
              </div>
        
              <div style="display: flex;gap: 30px;">
                <button style="margin-top: 10px;margin-bottom: 10px;" *ngIf="isMinerOp && showInput" (click)="showReject()"  class="response--container-form-container-form-btn-dev" mat-fab extended color="primary">
                  Cancelar
                </button>
                <button style="margin-top: 10px;" *ngIf="isMinerOp && showInput" type="submit" class="response--container-form-container-form-btn-sec" mat-fab extended color="primary">
                  Enviar Solicitud
                </button>
              </div>
             
            </div>
          </div>
          <!-- </div> -->
        </div>
      </form>
      
        <div *ngIf="isAudio" class="audio-player">
          <div class="album-cover"></div>
          <div class="player-controls">
            <div class="song-info">
              <div class="song-title">{{audioName}}</div>
              <p class="artist"></p>
            </div>
            <div class="response--audio-container-btns">
              <input type="range"
                     min="0"
                     max="100"
                     [value]="progress"
                     (input)="seekTo($event)" />
            </div>
            <div class="buttons">
              <button *ngIf="!isPlaying" (click)="play('PLAY')" class="play-btn"><svg viewBox="0 0 16 16" class="bi bi-play-fill" fill="currentColor" height="16" width="16" xmlns="http://www.w3.org/2000/svg" style="color: white"> <path fill="white" d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path> </svg></button>
              <button *ngIf="isPlaying" (click)="play('PAUSE')" class="pause-btn"><svg viewBox="0 0 16 16" class="bi bi-pause-fill" fill="currentColor" height="16" width="16" xmlns="http://www.w3.org/2000/svg" style="color: white"> <path fill="white" d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path> </svg></button>
            </div>
          </div>
        </div>
      
      <div class="response--visors-container-visor">
        <!--<app-file-viewer *ngIf="pdfSrc.length > 0" [fileUrl]="pdfSrc"></app-file-viewer>-->
        <div *ngIf="pdfSrc">
          <object [attr.data]="pdfSrc" type="application/pdf" width="100%" height="600px">
            <p>
              Tu navegador no soporta la visualización de PDF. Puedes
              <a [href]="pdfSrc">descargar el archivo aquí</a>.
            </p>
          </object>

        </div>
        <div class="response--visors-container-visor-excel">
          <app-file-viewer-excel *ngIf="excelSrc != false" [fileUrl]="excelSrc!.toString()"></app-file-viewer-excel>
        </div>
      </div>

    </div>
  </div>
</section>
<!--NUEVO REPRODUCTOR-->
<!--<div class="audio-player">
  <div class="album-cover"></div>
  <div class="player-controls">
    <div class="song-info">
      <div class="song-title">{{audioName}}</div>
      <p class="artist"></p>
    </div>
    <div class="response--audio-container-btns">
      <input type="range"
             min="0"
             max="100"
             [value]="progress"
             (input)="seekTo($event)" />
    </div>
    <div class="buttons">
      <button *ngIf="!isPlaying" (click)="play('PLAY')" class="play-btn"><svg viewBox="0 0 16 16" class="bi bi-play-fill" fill="currentColor" height="16" width="16" xmlns="http://www.w3.org/2000/svg" style="color: white"> <path fill="white" d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path> </svg></button>
      <button *ngIf="isPlaying" (click)="play('PAUSE')" class="pause-btn"><svg viewBox="0 0 16 16" class="bi bi-pause-fill" fill="currentColor" height="16" width="16" xmlns="http://www.w3.org/2000/svg" style="color: white"> <path fill="white" d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path> </svg></button>
    </div>
  </div>
</div>-->






<ng-template #noResponse>
  <span>Esperando respuesta del area asignada</span>
</ng-template>
