<form class="example-form" [formGroup]="formPQR" (ngSubmit)="submit()">

  <mat-form-field>
    <mat-label>Medio de Radicacion</mat-label>
    <mat-select formControlName="means">
      <mat-option value="Correo Electronico">Correo Electronico</mat-option>
      <mat-option value="Llamada Telefonica">Llamada Telefonica</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Tipo de PQR</mat-label>
    <mat-select formControlName="pqrType">
      <mat-option *ngFor="let type of types" [value]="type.id">{{type.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Tipo de Documento</mat-label>
    <mat-select formControlName="documentType">
      <mat-option *ngFor="let type of typesdoc" [value]="type.nombre">{{type.nombre}}</mat-option>

    </mat-select>
  </mat-form-field>


  <!--------------------------------------------------------------->
  <!----------------------- FILTER BY USER ------------------------>
  <!--------------------------------------------------------------->
  <!--------------------------------------------------------------->


  <mat-form-field>
    <mat-label>Numero de Documento</mat-label>
    <input matInput formControlName="documentNumber" (keyup)="applyFilterUser($event)" #input>
  </mat-form-field>

  <div class="mat-elevation-z9" *ngIf="empty">
    <table mat-table [dataSource]="dataSourceUser" matSort>


      <ng-container matColumnDef="id">
        <mat-header-cell mat-header-cell *matHeaderCellDef mat-sort-header> ID </mat-header-cell>
        <mat-cell (click)="onCheckboxChangeUser(row.numeroDocumento)" mat-cell *matCellDef="let row"> {{row.id}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="document">
        <mat-header-cell mat-header-cell *matHeaderCellDef mat-sort-header> Numero de Documento </mat-header-cell>
        <mat-cell (click)="onCheckboxChangeUser(row.numeroDocumento)" mat-cell *matCellDef="let row"> {{row.numeroDocumento}} </mat-cell>
      </ng-container>


      <mat-header-row *matHeaderRowDef="displayedColumnsUser"></mat-header-row>
      <mat-row matRipple *matRowDef="let row; columns: displayedColumnsUser;"
               (click)="selectRow(row)"
               [ngClass]="{'selected-row': selectedRow === row}">

      </mat-row>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
      </tr>
    </table>

    <!--<mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>-->
  </div>

  <!--------------------------------------------------------------->
  <!--------------------------------------------------------------->
  <!--------------------------------------------------------------->
  <!--------------------------------------------------------------->

  <mat-form-field>
    <mat-label>Fecha de Recepcion</mat-label>
    <input matInput [matDatepicker]="picker1" formControlName="dateReception">
    <!-- <mat-hint>DD/MM/YYYY</mat-hint> -->
    <mat-datepicker-toggle matIconSuffix [for]="picker1"></mat-datepicker-toggle>
    <mat-datepicker #picker1></mat-datepicker>
  </mat-form-field>




  <!--------------------------------------------------------------->
  <!-----------------------DATA FROM EUREKA------------------------>
  <!--------------------------------------------------------------->
  <!--------------------------------------------------------------->

  <mat-form-field class="example-full-width">
    <mat-label>ID Usuario</mat-label>
    <input matInput formControlName="userId">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Nombre del Usuario</mat-label>
    <input matInput formControlName="name">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Estado</mat-label>
    <input matInput formControlName="state">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Criticidad</mat-label>
    <input matInput formControlName="criticity">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Telefono Celular 1</mat-label>
    <input matInput formControlName="phone1">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Telefono Celular 2</mat-label>
    <input matInput formControlName="phone2">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>WhatsApp</mat-label>
    <input matInput formControlName="whatsapp">
  </mat-form-field>

  <mat-form-field class="example-full-width">
    <mat-label>Observaciones</mat-label>
    <input matInput formControlName="observaciones">
  </mat-form-field>


  <button class="btn-example" type="submit" mat-flat-button>Guardar PQR</button>

</form>

<!--------------------------------------------------------------->
<!------------------------FORM STEP 2---------------------------->
<!--------------------------------------------------------------->
<!--------------------------------------------------------------->

<form [formGroup]="formPQR2" (ngSubmit)="submit2()">
  <mat-form-field class="example-full-width">
    <mat-label>Numero de Documento</mat-label>
    <input matInput formControlName="documentNumber">
  </mat-form-field>


  <mat-form-field>
    <mat-label>Rango de fechas</mat-label>
    <mat-date-range-input [rangePicker]="picker">
      <input matStartDate formControlName="start" placeholder="Start date">
      <input matEndDate formControlName="end" placeholder="End date">
    </mat-date-range-input>
    <mat-hint>DD/MM/YYYY â€“ DD/MM/YYYY</mat-hint>
    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-date-range-picker #picker></mat-date-range-picker>

    <!--@if (range.controls.start.hasError('matStartDateInvalid')) {
    <mat-error>Invalid start date</mat-error>
    }
    @if (range.controls.end.hasError('matEndDateInvalid')) {
    <mat-error>Invalid end date</mat-error>
    }-->
  </mat-form-field>

  <button class="btn-example" type="submit" mat-flat-button>Consultar servicios</button>
</form>



<mat-form-field>
  <mat-label>Filter</mat-label>
  <input matInput (keyup)="applyFilter($event)" placeholder="Ex. Mia" #input>
</mat-form-field>

<div class="mat-elevation-z8">
  <table mat-table [dataSource]="dataSource" matSort>


    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> ID </th>
      <td mat-cell *matCellDef="let row"> {{row.serviceId}} </td>
    </ng-container>


    <ng-container matColumnDef="date">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha de Servicio </th>
      <td mat-cell *matCellDef="let row">
        {{row.dateService | date: 'dd/MMM/yyy'}} a las:
        {{row.dateService | date: 'HH:ss'}}
      </td>
    </ng-container>


    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
      <td mat-cell *matCellDef="let row">
        <mat-checkbox (change)="onCheckboxChange($event,row.serviceId)" class="example-margin"></mat-checkbox>
        <i (click)="getDetails(row.serviceId)" class="bi bi-info-square-fill" style="cursor:pointer;width: 100px;"></i>
      </td>
    </ng-container>



    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

    <!-- Row shown when there is no matching data. -->
    <tr class="mat-row" *matNoDataRow>
      <td class="mat-cell" colspan="4">No data matching the filter "{{input.value}}"</td>
    </tr>
  </table>

  <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" aria-label="Select page of users"></mat-paginator>
</div>


<div>
  <form [formGroup]="formPQR3" (ngSubmit)="submitPQR()">

    <div *ngFor="let ser of services; let i = index">
      <h2>
        {{ser.fechaServicio | date: 'dd/MMM/yyy'}} a las: {{ser.horaRecogida | date: 'HH:ss'}}
      </h2>
      <mat-form-field class="example-full-width">
        <mat-label>Id Servico</mat-label>
        <input matInput [value]="ser.id" formControlName="id{{i}}">
      </mat-form-field>


      <mat-form-field>
        <mat-label>Motivo</mat-label>
        <mat-select formControlName="motivo{{i}}">
          <mat-option *ngFor="let sec of secundaries" [value]="sec.id">{{sec.name}}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Problema Central</mat-label>
        <mat-select formControlName="problema{{i}}">
          <mat-option *ngFor="let pri of principals" [value]="pri.id">{{pri.name}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <button class="btn-example" type="submit" mat-flat-button>Guardar</button>
  </form>
</div>
